!function(){"use strict";var e={n:function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,{a:t}),t},d:function(n,t){for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},o:function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}},n=window.jQuery,t=e.n(n),r=function(){var e;return null===(e=document.querySelector('.woocommerce-checkout input[name="payment_method"]:checked'))||void 0===e?void 0:e.id},o=function(e){return/^payment_method_payoneer-(checkout|afterpay)/i.test(e)},a=function(){return o(r())},i=function(){return"1"===window.PayoneerData.isPayForOrder},u=function(e){var n=".payment_box."+e;return document.querySelector(n)},c=function(){var e=window.PayoneerData.hostedFlowOverrideFlag;return document.querySelector('input[name="'.concat(e,'"]'))},l=function(){var e=c();return!0===(null==e?void 0:e.disabled)},d=function(e){var n=c();n&&(n.disabled=!e)};function s(e,n,t,r,o,a,i){try{var u=e[a](i),c=u.value}catch(e){return void t(e)}u.done?n(c):Promise.resolve(c).then(r,o)}var f=window.regeneratorRuntime,m=e.n(f),p=function(e){var n;return null!==(n=window.Payoneer)&&void 0!==n&&n.CheckoutWeb?window.Payoneer.CheckoutWeb(e):new Promise((function(n,t){var r,o,a=document.createElement("script");a.src=(r=e.env,new URL(null===(o=window.PayoneerData.webSdkUmdUrlTemplate)||void 0===o?void 0:o.replace("<env>",r))),a.onload=n,a.onerror=t,document.head.appendChild(a)})).then((function(){return window.Payoneer.CheckoutWeb(e)}))},y=null,h="",v=function(){var e,n=(e=m().mark((function e(n){var t,r,o,a,i,u,c;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById(window.PayoneerData.listUrlContainerId)){e.next=3;break}throw new Error("No list-url input present, cannot create SDK instance");case 3:if(r=window.PayoneerData,o=r.listIdAttribute,a=r.listEnvAttribute,i=r.websdkStyles,u=t.getAttribute(a),c=t.getAttribute(o),y&&h===c){e.next=12;break}return e.next=8,p({env:u,longId:c,onBeforeError:n,preload:["cards"],styles:i});case 8:y=e.sent,h=c,e.next=13;break;case 12:y.updateLongId(c);case 13:return e.abrupt("return",y);case 14:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function i(e){s(a,r,o,i,u,"next",e)}function u(e){s(a,r,o,i,u,"throw",e)}i(void 0)}))});return function(_x){return n.apply(this,arguments)}}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function b(e){var n=function(e){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=w(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(n)?n:n+""}function k(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}var I=function(){return e=function e(n){var t=n.sdk,r=n.paymentFieldsContainerId,o=n.paymentFieldsComponentAttribute;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdk=t,this.paymentFieldsContainerId=r,this.paymentFieldsComponentAttribute=o},n=[{key:"setElement",value:function(e){this.element=e,this.dropInContainer=this.element.querySelector(".".concat(this.paymentFieldsContainerId)),this.dropInComponentName=this.dropInContainer.getAttribute(this.paymentFieldsComponentAttribute)}},{key:"render",value:function(){if(!this.element)throw new Error("render() called before element was set.");try{this.mount()}catch(e){return console.error(e),!1}return!0}},{key:"dropIn",value:function(){if(this._dropIn)return this._dropIn;if(!this.sdk.availableDropInComponents().map((function(e){return e.name})).includes(this.dropInComponentName))throw new Error("Invalid dropIn component provided: "+this.dropInComponentName);return this._dropIn=this.sdk.dropIn(this.dropInComponentName,{hidePaymentButton:!0})}},{key:"mount",value:function(){var e=this.dropIn();this.dropInContainer.innerHTML="",e.mount(this.dropInContainer)}},{key:"unmount",value:function(){try{this.dropIn().unmount()}catch(e){console.error(e)}}},{key:"pay",value:function(){this.sdk.reload(),this.dropIn().pay()}}],n&&k(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}(),g={},S=function(e,n){var t=window.PayoneerData,r=t.paymentFieldsContainerId,o=t.paymentFieldsComponentAttribute,a=t.onErrorRefreshFragmentFlag;g[e]=new I({sdk:n,paymentFieldsContainerId:r,paymentFieldsComponentAttribute:o,onErrorRefreshFragmentFlag:a});var i=u(e);return i&&g[e].setElement(i),g[e]};function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}document.addEventListener("DOMContentLoaded",(function(){var e=t()("form.checkout"),n=t()("#order_review"),c=function(e,n,r){var o,a=window.PayoneerData.onErrorRefreshFragmentFlag;if(console.error("WebSDK error:",{checkout:e,component:n,data:r}),!["EXPIRED_SESSION","SYSTEM_FAILURE"].includes(null==r||null===(o=r.interaction)||void 0===o?void 0:o.reason))return d(!0),!0;if(i()){var u=new URL(document.location);return u.searchParams.set(window.PayoneerData.payOrderErrorFlag,!0),window.location.href=u.toString(),!1}var c=document.querySelector('input[name="'.concat(a,'"]'));c&&(c.value="true"),t()(document.body).trigger("update_checkout")},s=function(){v(c).then((function(e){var n,t=!1,r=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return C(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?C(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var _n=0,r=function(){};return{s:r,n:function(){return _n>=e.length?{done:!0}:{done:!1,value:e[_n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw o}}}}(Array.from(document.querySelectorAll('.woocommerce-checkout input[name="payment_method"]')).map((function(e){return e.id})).filter(o));try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!(t=S(a,e).render()))break}}catch(e){r.e(e)}finally{r.f()}d(!t)})).catch((function(e){console.error("WebSDK creation error:",e),d(!0)}))},f=function(){var e,n=(e=r(),g[e]);n&&n.pay()};t()(document.body).on("updated_checkout",s),e.on("checkout_place_order_success",(function(n,o){if(a()&&l())return f(),o.redirect="#payoneer-redirect",setTimeout((function(){e.removeClass("processing").unblock(),t().scroll_to_notices(t()(u(r())))}),1500),!0})),n.on("submit",(function(e){var r;a()&&l()&&(e.preventDefault(),e.stopImmediatePropagation(),(r=n,r.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),t().ajax({type:"POST",url:window.wc_checkout_params.ajax_url,xhrFields:{withCredentials:!0},dataType:"json",data:{action:"payoneer_order_pay",fields:r.serialize(),params:new URL(document.location).searchParams.toString()}}).always((function(){return r.unblock()}))).then((function(){return f()})).catch((function(){window.scrollTo(0,0),window.location.reload()})))})),i()&&s()}),!1)}();
//# sourceMappingURL=payoneer-checkout.js.map